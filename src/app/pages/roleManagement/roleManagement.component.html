<h1>User Roles</h1>

<nb-card>
  <nb-card-header>Use the tabs below to manage users; you can add & disable users, as well as change their role status
  </nb-card-header>
  <nb-card-body>
    <nb-tabset>
      <nb-tab tabTitle="Add Users" tabIcon="person-add-outline" responsive>
        <form class="text-center" (ngSubmit)="createUser()" #form="ngForm" aria-labelledby="title">

          <ng-container>
            <h6>To create a new user please enter the email address of the user you want to create, a password will be
              automatically generated (but you can change it if you want). Finally, select the role the user is to have
              within
              the system (roles can be managed after creation)</h6>

            <br>
            <h6>Users Email</h6>
            <br>
            <div class="form-control-group">
              <input nbInput [(ngModel)]="userRegistration.email" #email="ngModel" id="input-name" name="email"
                placeholder="Enter Email" autofocus fieldSize="medium"
                [status]="email.dirty ? (email.invalid  ? 'danger' : 'success') : 'basic'" [required]=true
                [attr.aria-invalid]="email.invalid && email.touched ? true : null" [pattern]=emailPattern>
              <ng-container *ngIf="email.invalid && email.touched">
                <p class="caption status-danger" *ngIf="email.errors?.required">
                  email is invalid, please enter a email address
                </p>
                <p class="caption status-danger" *ngIf="email.errors?.pattern">
                  email is invalid, please enter a email address
                </p>
              </ng-container>
            </div>

            <br>
            <h6>Users Password</h6>

            <br>

            <div class="input-group mb-3 justify-content-center">
              <input nbInput [(ngModel)]="userRegistration.password" #password="ngModel" id="input-name" name="password"
                placeholder="Enter password" autofocus fieldSize="medium" (focus)="generatePassword()"
                [status]="password.dirty ? (password.invalid  ? 'danger' : 'success') : 'basic'" [required]=true
                [attr.aria-invalid]="password.invalid && password.touched ? true : null" minlength="8" maxlength="20">
              <ng-container *ngIf="password.invalid && password.touched">
                <p class="caption status-danger" *ngIf="password.errors?.required">
                  password is invalid, please enter a password address
                </p>
              </ng-container>
              &nbsp;&nbsp;
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" nbButton type="button" status="info" size="large"
                  (click)="generatePassword()">
                  Generate New
                </button>
              </div>
            </div>

            <br>
            <h6>Users Role</h6>
            <br>

             <div class="form-control-group">
              <nb-radio-group id="role" name="role" [(ngModel)]="userRegistration.role" #role="ngModel">
                <nb-radio class="inline-radio" *ngFor="let role of roles" [value]=role>{{role}}
                </nb-radio>
              </nb-radio-group>
             </div>

            <br>

            <button nbButton fullWidth status="primary" size="large" [disabled]="submitted || !form.valid"
              [class.btn-pulse]="submitted">
              Register {{userRegistration.email}}
            </button>

          </ng-container>

          <ng-template #loading>
            <nb-card [nbSpinner]="true" nbSpinnerSize="giant" nbSpinnerStatus="primary">
              <nb-card-body>
                Please wait while we get things ready
              </nb-card-body>
            </nb-card>
          </ng-template>
        </form>


      </nb-tab>
      <nb-tab tabTitle="Manage Existing User Roles" tabIcon="clipboard-outline" responsive>
      </nb-tab>
    </nb-tabset>
  </nb-card-body>
</nb-card>